<!DOCTYPE html>
<html>
<head>
	<title>Log in!</title>
	<link rel="stylesheet" type="text/css" href="/resources/style.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js">//jQuery</script>
	<script src="/resources/gui.js"></script>
	<script>

		//// POST DATA TO THE SERVER //////////////////////////////////////////////////////////////

		function post() {
			var name = document.getElementById("name").value.toLowerCase();
			var password = document.getElementById("pw").value;
			jQuery.post("/login", {username: name, pass: password}, function(result) {
			switch(result.split(",")[0]) {
					case "complete":
						password = result.split(",")[1];
						document.cookie = name + "," + password + "; path=/prefs.html";
						document.getElementById("warn").style.opacity = "0";
						window.location = "/prefs.html";
					break;
					case "password": //the password deosn't match the username
						document.getElementById("warn").innerHTML = "Incorrect password.";
						document.getElementById("warn").style.opacity = "1";
					break;
					case "username": //username doesn't exist
						document.getElementById("warn").innerHTML = "This user doesn't exist!";
						document.getElementById("warn").style.opacity = "1";
					break;
					case "verify": //the user's email isn't verified
						document.getElementById("warn").innerHTML = "You need to verify your email before logging in.";
						document.getElementById("warn").style.opacity = "1";
					break;

					default: //error
						document.getElementById("warn").innerHTML = "A server error occured:\n" + result;
						document.getElementById("warn").style.opacity = "1";
					break;
				}
			});
		}
	</script>
</head>
<body>
	<div class="topMenu"> <!--The top bar thing-->
		<img src="./images/navicon.png" id="navicon" onclick="openNav()""><!--The menu symbol-->
	</div>
	<a href="javascript:window.open('http://leppu.tumblr.com/');"><img id="tumblr" src="./images/tumblr.png"></a> <!--Leppu's Tumblr-->
	<a href="javascript:window.open('https://twitter.com/petra_nordlund');"><img id="twitter" src="./images/twitter.png"></a> <!--Leppu's Twitter-->
	<a href="javascript:window.open('http://www.praguerace.com/rss.php');"><img id="rss" src="./images/rss.png"></a> <!--Hiveworks's RSS--> <!--TBH I have no idea about how RSS works or how to use it-->
	<a href="javascript:window.open('https://www.patreon.com/praguerace');"><img id="patreon" src="./images/patreon.png"></a> <!--Leppu's Patreon--> <!--Please go donate!-->

	<div id="vertiBar"></div> <!--The side bar thing-->

	<img id="logo" src="./images/doofR.png" onclick="javascript:window.location = '/'"> <!--The werewolf face-->

	<div class="sidenav" id="sidepanel"> <!--The sidenav itself-->
		<br><br><br><br> <!--Highly sophisticated methods of spacing-->
		<h1><a href="javascript:void(0)" id="closebtn" onclick="closeNav()">&times;</a></h1>
		<h2><a href="/index.html">Back to the homepage</a></h2>
		<br><br><br>
		<h2><a href="/subscribe.html">Subscribe to updates</a></h2>
		<br><br><br>
		<h2><a href="javascript:window.open('http://www.praguerace.com/');">Read the comic!</a></h2>
		<br><br><br>
		<h2><a href="/about.html">About this</a></h2>
	</div>

	<div class="notMenu">
		<form action="javascript:post();" id="form">
			<h2>Email:</h2>
			<br>
			<input class="text" type="text" id="name" name="username">
			<p>Log in to change your preferences.</p>
			<br>
			<h2>Password</h2>
			<input class="text" type="password" id="pw" name="pass">
			<br><br>
			<input type="submit" id="submit" value="Log in!">
			<br>
		</form>
		<br>
		<div id="warn">Lorem ipsum dolor sit amet</div>
	</div>
</body>
</html>